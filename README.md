# Malware Detection using Machine Learning

## Overview
This repository contains the final year project created by(Hurricane Group) **Harsh Swaroop Dubey**, **Aditya Singh Diwakar**, **Anthoni Kindo**, and **Jagmohan Rajwade**. The project focuses on malware detection using machine learning techniques.

## Project Description
Malware detection is a critical aspect of cybersecurity, as malicious software poses significant threats to computer systems and networks. Malware detection through standard, signature-based methods is getting increasingly difﬁcult since all current malware applications tend to have multiple polymorphic layers to avoid detection or to use side mechanisms to automatically update themselves to a newer version at short periods of time to avoid detection by any antivirus software.

Machine learning helps antivirus software detect new threats without relying on signatures. In the past, antivirus software relied largely on fingerprinting, which works by cross-referencing files against a huge database of known malware.

In this project, we have developed a machine learning model capable of detecting malware by analyzing various features extracted from binary files. We have used a dataset containing samples. of both malware and benign files to train and evaluate our model. The machine learning algorithms employed include decision trees, random forests, support vector machines (SVM), and deep learning techniques such as convolutional neural networks (CNNs).

## PE-header-based malware detection
The main part of this project is the machine learning model in which we used Random Forest classifier tree to classify the malware/benign files. The dataset that we are using contains 70.1% malwares and 29.9% benign files.

As per the splitting part goes, we divided the data into 70% training data and 30% testing data and then we selected the important features that are required for the classification using the extratrees.feature_importances_ function and then we compared the score of Decision Tree Classifier and Random Forest classifier and found that Random Forest Classifier’s score (99.45%) is better than Decision Tree Classifier (99.04%), hence we selected it for training and then after training we saved it as Classifier.pkl and also saved the features that we found important as features.pkl to keep track of the required function while extracting it from any real file.

After the Machine Learning part comes the file extraction part in which we extract the features that are required for the classification. The major challenge that we faced while coding this project was to extract the features of the PE Header file and then storing it for the saved machine learning model. For extracting the content of the PE Header we used pefile library (https://pypi.org/project/pefile/). The selection of those features is done using the feature.pkl model that stores all the important features for the Random Forest Classifier. The extraction of the PE Header files is done using pefile library in python and then the selected features are then given to the classifier.pkl machine and it predicts the output.

## Malicious URL detection
This part of the program also consists of two phases, Cleaning the data for the Logistic Regression and then training the machine to identify if it is malicious or not. The Model is sketched out in such a way that it can meaningfully understand the data from which it has to be trained upon and tried to develop a defined behaviour from the data-sets. Data-sets are the backbone of any model and hence it should be adequate and precise data for good as well as bad URLs present in the data for the model to be trained upon. The Machine Learning for the malicious website detection will first involve in cleaning of our data within the data-sets. We used pandas and defined our own vectorizer to clear the data-sets and then used Logistic Regression to train our model.

Since the URLs are different from our normal text documents, a sanitization method is used to get the relevant data from raw URLs.

We will implement our sanitization function in python to filter the URLs. This will give us the desired URL data-set values to train the model and test it. The data-set will have two column structure one for URLs and other for labels (malicious or not).

Then we used Tf-idf machine learning text feature extraction approach from the sklearn python module. Before that we need to read the data-sets into data frames and matrix which can be understood by the vectorizer we prepared and later pass onto the term-frequency and inverse document frequency text extraction approach. We used pandas module in python for that task. As stated above we used logistic regression method to train our model but before that we passed the data to our custom vectorizer function using Tf-idf approach and after that we can train and test our ML model.

Still the model was not able to predict all the good URLs and hence club good URLs with bad URLs so we used the classical method of URL filtering with conjunction to the machine learning model i.e., Whitelist Filter. It is the list of websites that we know are good and at-least non-malicious and won’t harm our users. So, we allow these particular websites through our internet traffic, the opposite is called as blacklisting. It’s a very simple but efficient approach to segregate our network traffic, similarly we implemented that in our machine learning model.

## Repository Structure
- `Dataset/`: Contains the dataset used for training and testing the machine learning model.
- `Classifier/`: It containks the pickel files.
- `ML_Model/`: Saved machine learning models.
- `main.py/`: Main file to run the project.
- `README.md`: This file, providing an overview of the project.

## Base Paper
Our project is inspired by the research paper titled "Malware Detection using Machine Learning Techniques" by XYZ et al. You can find the paper [here](https://github.com/HarshDubey1011/Malware-Detection/blob/main/BasePaper.pdf).

## Synopsis
The synopsis for this project, you can access it [here](https://github.com/HarshDubey1011/Malware-Detection/blob/main/Synopsis.pdf).

## Thesis
The thesis for this project, you can access it [here](https://github.com/HarshDubey1011/Malware-Detection/blob/main/thesis%20front-1.pdf).

## Report
The report for this project, you can access it [here](https://github.com/HarshDubey1011/Malware-Detection/blob/main/Malware-Detection-Report.docx).

## PPT
The Final Presentation PPT for this project, you can access it [here](https://github.com/HarshDubey1011/Malware-Detection/blob/main/Anomaly-Based-Malware-Detection-Using-Machine-Learning.pptx).

## Dataset
We used the PE Header dataset available on Kaggle, which can be accessed [here](https://www.kaggle.com/datasets/dscclass/malware).

## Usage
1. Clone the repository:
```bash
   git clone https://github.com/HarshDubey1011/Malware-Detection.git
```
2. Navigate to the project directory:
```bash
   cd Malware-Detection
```
3. Install the required dependencies:
```bash
   pip install -r requirements.txt
```
4. Run the command-line interface (CLI) application:
```bash
   python main.py
```
5. Run the website:
```bash
   python app.py
```

## Screenshot
![Screenshot-1](https://github.com/HarshDubey1011/Malware-Detection/assets/64142529/efff2227-b662-439d-9e72-babbe3b6a9ac)
![Screenshot-2](https://github.com/HarshDubey1011/Malware-Detection/assets/64142529/01816946-05e1-4774-90ff-60846e884de8)
![website-1](https://github.com/HarshDubey1011/Malware-Detection/assets/64142529/a9d4c1e0-e09a-4beb-9d53-572695fe3b23)
![website-2](https://github.com/HarshDubey1011/Malware-Detection/assets/64142529/c310e44e-f58e-488b-b6a5-6f9c85682150)

## Contributors
- Harsh Dubey
- Aditya Diwakar
- Anthoni Kindo
- Jagmohan Rajwade

## License
This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
